## Функции, чистота функций, side-effects

Функция - это блок кода, который выполняет определенную операцию и может возвращать результат. Функции могут быть определены в Python с помощью ключевого слова def, и могут содержать параметры и инструкции для выполнения операции. Важным понятием, связанным с функциями, является их чистота.

Чистота функций - это свойство функций, которое означает, что функция всегда возвращает одинаковый результат для одних и тех же входных данных, и не имеет побочных эффектов. Побочные эффекты включают изменение глобальных переменных, ввод/вывод и изменение состояния объектов.

Side-effect - это побочный эффект, который происходит при выполнении функции и влияет на состояние программы. Примерами side-effect могут быть изменение глобальных переменных, вывод информации на экран, запись в файлы и т.д.

Рассмотрим примеры на применение функций и их side-effect в Python:

```python
# Функция, которая возвращает сумму двух чисел
def add_numbers(x, y):
    return x + y

result = add_numbers(2, 3)
print(result)  # Выводит "5"

# Функция, которая меняет значение глобальной переменной
global_var = 10
def change_global_var():
    global global_var
    global_var = 20

change_global_var()
print(global_var)  # Выводит "20"

# Функция, которая записывает данные в файл
def write_data_to_file(data):
    with open("data.txt", "w") as f:
        f.write(data)

write_data_to_file("Hello, world!")

# Функция, которая имеет side-effect, но не изменяет состояние программы
def print_message(message):
    print(message)

print_message("Hello, world!")
```

В первом примере мы определяем функцию add_numbers, которая возвращает сумму двух чисел. Эта функция чиста, так как всегда возвращает одинаковый результат для одних и тех же входных данных и не имеет side-effect.

Во втором примере мы определяем функцию change_global_var, которая меняет значение глобальной переменной global_var. Эта функция имеет side-effect, так как изменяет значение глобальной переменной.

В третьем примере мы определяем функцию write_data_to_file, которая записывает данные в файл. Эта функция имеет side-effect, так как изменяет состояние файловой системы.

В четвертом примере мы определяем функцию print_message, которая выводит сообщение на экран. Эта функция имеет side-effect, но не изменяет состояние программы.

Таким образом, функции могут использоваться для выполнения различных операций в Python. При этом важно учитывать их чистоту и возможность возникновения side-effect. Чистота функций обеспечивает более простой и надежный код, а избегание side-effect позволяет сделать код более предсказуемым и понятным.

Существуют и другие принципы, связанные с функциями в Python, которые могут улучшить качество кода и сделать его более понятным и поддерживаемым. Например, функции могут быть разбиты на более мелкие функции, чтобы сделать код более модульным и удобным для чтения. Также следует учитывать передачу аргументов в функции и использование именованных параметров, чтобы сделать код более читаемым и понятным.

Ниже приведен пример разбиения функции на более мелкие функции:

```python
# Функция, которая определяет, является ли число простым
def is_prime(number):
    if number < 2:
        return False
    for i in range(2, number):
        if number % i == 0:
            return False
    return True

# Функция, которая возвращает список простых чисел в диапазоне от start до end
def get_primes(start, end):
    primes = []
    for number in range(start, end+1):
        if is_prime(number):
            primes.append(number)
    return primes

# Вызов функции get_primes и вывод списка простых чисел
primes = get_primes(1, 20)
print(primes)  # Выводит "[2, 3, 5, 7, 11, 13, 17, 19]"
```

В этом примере мы определяем функцию is_prime, которая определяет, является ли число простым, и функцию get_primes, которая возвращает список простых чисел в заданном диапазоне. Функция get_primes использует функцию is_prime внутри себя для проверки каждого числа в диапазоне.

Таким образом, использование функций и учет их чистоты и side-effect может улучшить качество кода и сделать его более понятным и поддерживаемым.

Область видимости переменных - это часть программы, в которой переменная может быть использована. В Python существует три типа областей видимости переменных: глобальная, локальная и неявная.

Глобальная область видимости относится к переменным, определенным вне функции или класса. Эти переменные могут быть использованы в любой части программы, но могут быть изменены только с помощью ключевого слова global.

Локальная область видимости относится к переменным, определенным внутри функции или метода. Эти переменные могут быть использованы только внутри функции или метода, и не могут быть использованы в других частях программы.

Неявная область видимости относится к переменным, которые не определены в текущей функции или методе, но могут быть использованы благодаря наследованию или импортированию модулей.

Рассмотрим примеры переменных и их областей видимости в Python:

```python
# Глобальная переменная
global_var = 10

# Локальная переменная
def func():
    local_var = 20
    print(local_var)

# Использование глобальной переменной в функции
def func2():
    print(global_var)

# Изменение глобальной переменной в функции
def func3():
    global global_var
    global_var = 30

func()  # Выводит "20"
func2()  # Выводит "10"
func3()
print(global_var)  # Выводит "30"
```

В этом примере мы определяем глобальную переменную global_var, которая может быть использована в любой части программы. Затем мы определяем функцию func, которая имеет локальную переменную local_var, которая может быть использована только внутри функции.

В функции func2 мы используем глобальную переменную global_var, которая может быть использована в любой части программы. В функции func3 мы изменяем значение глобальной переменной с помощью ключевого слова global.

Также в Python существует встроенная функция locals(), которая возвращает словарь локальных переменных в текущей области видимости, и функция globals(), которая возвращает словарь глобальных переменных. Эти функции могут быть полезны для отладки и понимания областей видимости переменных в программе.

```python
def func4():
    local_var = 20
    print(locals())  # Выводит "{'local_var': 20}"

print(globals())  # Выводит словарь глобальных переменных
func4()  # Выводит словарь локальных переменных
```

Таким образом, понимание областей видимости переменных может помочь в разработке более надежных и понятных программ. При работе с переменными следует учитывать их область видимости и возможность изменения значения переменной в разных частях программы.

Также важно учитывать принципы именования переменных в Python, чтобы сделать код более понятным и читаемым. Общепринятой практикой является использование существительных для именования переменных, начиная с маленькой буквы. Также следует избегать использования ключевых слов и встроенных функций в качестве имен переменных.

```python
# Использование правильного именования переменных
radius = 5
area = 3.14 * radius ** 2

# Избегание использования ключевых слов в качестве имен переменных
list = [1, 2, 3]  # Не рекомендуется
```

Таким образом, понимание областей видимости переменных и принципов их именования может помочь в разработке более надежных и понятных программ в Python.
