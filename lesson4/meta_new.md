
## new
`__new__()` - это магический метод в Python, который вызывается при создании нового объекта класса. Он является статическим методом класса, который принимает класс в качестве первого аргумента, а затем любые другие аргументы, переданные при создании нового объекта.

Метод `__new__()` может использоваться для управления созданием объектов класса и может быть полезен, например, для создания синглтонов (классов, для которых должен существовать только один объект), кеширования объектов или для создания объектов, которые имеют специальное поведение при создании.

Рассмотрим простой пример класса `Person`:

```python
class Person:
    def __init__(self, name, age):
        self.name = name
        self.age = age
```

При создании нового объекта класса `Person` Python вызывает метод `__new__()` и передает ему класс `Person` и любые аргументы, переданные при создании объекта. Метод `__new__()` создает и возвращает новый объект, который затем передается в метод `__init__()` для инициализации атрибутов.

## Метаклассы

Метаклассы - это специальные классы, которые определяют поведение других классов. Они позволяют изменять поведение классов при их создании, например, добавлять новые методы или атрибуты класса. Метаклассы используются редко, но могут быть полезны в некоторых случаях, например, для создания классов, которые автоматически регистрируются в системе, для создания классов с определенными атрибутами или методами, или для создания классов, которые имеют специальное поведение при их создании.


```python
class MyMeta(type):
    def __new__(cls, name, bases, attrs):
        attrs['my_attr'] = 42
        return super().__new__(cls, name, bases, attrs)

class MyClass(metaclass=MyMeta):
    pass

print(MyClass.my_attr)  # выводит 42
```

В этом примере мы создаем метакласс `MyMeta`, который добавляет атрибут `my_attr` к любому классу, созданному с использованием этого метакласса. Затем мы создаем класс `MyClass`, указывая метакласс `MyMeta` в качестве аргумента `metaclass`. При создании класса `MyClass` Python вызывает метод `__new__()` метакласса `MyMeta`, который добавляет атрибут `my_attr` к классу `MyClass`. В итоге мы можем обратиться к атрибуту `my_attr` класса `MyClass` и получить значение 42.


Каждый из этих аргументов имеет свою роль в создании класса.

- `cls` - это метакласс, который создается. Этот аргумент обычно используется для вызова методов метакласса, которые могут помочь при создании класса.
- `name` - это имя класса, который создается. Это имя передается как строка.
- `bases` - это кортеж базовых классов для создаваемого класса. В этом кортеже перечисляются все классы, от которых наследуется создаваемый класс.
- `attrs` - это словарь атрибутов, которые будут принадлежать создаваемому классу. Этот словарь содержит все атрибуты, которые были определены в теле класса, а также любые другие атрибуты, которые могут быть установлены метаклассом.

